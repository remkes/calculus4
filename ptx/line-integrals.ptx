<section xml:id="line-integrals">
  <title>Line Integrals of Vector Fields</title>
  <introduction>
    <p>
      As the start of this course, We integrated scalar fields over various regions in <m>\RR^3</m>.
      Now that we have defined vector fields,
      we can ask if there is a reasonable definition for integration of a vector field.
      This seems like an odd question:
      integrating scalar fields, such a density, made sense.
      What does it mean to integrate a vector field?
    </p>
    <p>
      We will start with integrating along a parametric curve.
      If we think of the vector field as a force field,
      then the integral of the vector field along the path will be interpreted as the <em>work</em>
      to move through the field.
      Alternatively,
      we can interpret the line integral as the work that the field accomplished to move the object.
      (The sign of the vector field can be changed to accomodate this variable perspective:
      working with or working against the field.)
    </p>
    <p>
      If <m>F</m> represents resistance to movement,
      like walking into the wind,
      then we look at the vectors as directions pushing with or against the movement.
      If <m>\gamma</m> is movement through a vector field,
      then its local direction at any moment is its tangent <m>\gamma^\prime(t)</m>.
      To determine whether or not we are moving into the wind,
      with the wind, or sideway through it,
      we have to compare the vector field and the tangent.
      We use dot product:
      <m>F \cdot \gamma^\prime(t)</m> is large if the vectors share a direction and zero when the vectors are perpendicular.
    </p>
    <p>
      However, we want this integral to only depend on the path,
      not the parametrization.
      Therefore, we should use attributes of the curve which are not dependant on the parametrization.
      The unit tangent <m>T(s)</m> is one such attribute (in terms of the arclength parameter <m>s</m>.
      <m>F \cdot T</m> measures the interaction of the movement along the curve with the vector field.
      The arclength infinitesimal <m>ds</m> is independent of parametrization.
      We use these tools to give the definition.
    </p>
    <definition>
      <statement>
        <p>
          The <term>line integral</term> of a vector field <m>F</m> along a path
          <m>\gamma(s): [0,L] \rightarrow \RR^n</m> is the integral of the scalar
          <m>F(\gamma(s)) \cdot T(s)</m> along the length of the curve.
          <me>
            \int_{\gamma} F \cdot T ds = \int_{\gamma} F \cdot ds \defeq \int_0^L F(\gamma(s)) \cdot T(s) ds
          </me>
        </p>
        <p>
          The first notation is more complete,
          but the shorter second notation is conventional.
        </p>
      </statement>
    </definition>
    <p>
      Using the arclength parameter for the definition if appropriate but inconvenient for calculation.
      Let <m>\gamma(t)</m> be an arbitrary parametrization.
      Then we can think of <m>s(t)</m>
      (the arclenth of the curve in terms of <m>t</m>)
      as a substitution of single variable integration.
      This substitution has <m>ds = |\gamma^\prime(t)| dt</m> and <m>T = \gamma^\prime(t) / |\gamma^\prime(t)|</m>,
      and the new bounds are <m>0</m> and <m>L</m>, the length of the curve.
      We can then transform the integral in the definition.
      <me>
        \int_{\gamma} F \cdot T ds = \int_0^L F(\gamma(s)) \cdot T(s) ds = \int_a^b F(\gamma(t)) \cdot \frac{\gamma^\prime(t)}{|\gamma^\prime(t)|} |\gamma^\prime(t)| dt = \int_a^b F(\gamma(t)) \cdot \gamma^\prime(t) dt
      </me>
    </p>
    <p>
      The line integral measures the work or effort it takes to move along the path through the vector field.
      It integral doesn't depend at all on the speed of moving through the vector field,
      since it is independent of the parametrization.
      The line integral is positive if it generally goes with the direction of the field and negative if it generally goes against.
      Since moving with <m>F</m> is positive and moving against <m>F</m> is negative,
      we sometime will want to replace <m>F</m> with <m>-F</m> when we want to think of working against the field as positive work.
    </p>
    <example>
      <statement>
        <p>
          Let's do a classic example: the force of gravity.
          We've already discussed the field
          (per unit mass)
          generated by a mass <m>M</m> at the origin.
          <me>
            F = \frac{GM}{\sqrt{(x^2+y^2+z^2)^3}} (-x, -y, -z)
          </me>
        </p>
        <p>
          We're going to reverse the sign here,
          since we want to do positive work when we go against gravity.
          <me>
            F = \frac{GM}{\sqrt{(x^2+y^2+z^2)^3}} (x, y, z)
          </me>
        </p>
        <p>
          Let's take an outward path
          <m>\gamma(t) = (t,t,t)</m> for <m>t \in [a,b]</m> and <m>b>a>0</m>.
          Then
          <md>
            <mrow>\gamma^\prime \amp  = (1,1,1)</mrow>
            <mrow>F(\gamma(t)) \amp  = \frac{GM}{\sqrt{(3t^2)^3}} (t,t,t)</mrow>
            <mrow>F(\gamma(t)) \cdot \gamma^\prime(t) \amp  = \frac{3t GM}{3\sqrt{3} t^3} = \frac{GM}{t^2\sqrt{3}}</mrow>
            <mrow>\int_{\gamma} F \cdot ds \amp  = \int_b^a \frac{GM}{t^2\sqrt{3}} = \frac{GM}{\sqrt{3}} \int_a^b \frac{1}{t^2} dx</mrow>
            <mrow>\amp  = \frac{GM}{\sqrt{3}} \left. \frac{-1}{t} \right|_a^b = \frac{GM}{\sqrt{3}} \left( \frac{1}{a} - \frac{1}{b} \right)</mrow>
            <mrow>\amp  = \frac{GmM(b-a)}{ab\sqrt{3}}</mrow>
          </md>
        </p>
        <p>
          If the distances <m>a</m> and <m>b</m> are large,
          but <m>a</m> and <m>b</m> are close to each other,
          then the change <m>a-b</m> is much more significant than the change in the term <m>ab</m> in the denominator.
          If we call <m>g = \frac{GM}{\sqrt{3}ab}</m> and pretend this is locally constant,
          the line integral (approximately) evaluates to <m>g(b-a)</m>.
          Recall we were working with force per unit mass,
          so if we act on a mass <m>m</m> we get a change in potential of <m>mg(b-a)</m>.
          This is the familiar high-school physics result of <m>mgh</m>,
          the increase in potential energy,
          here <m>h</m> is the change in height and <m>g</m> the local acceleration due to gravity. (Proving that our expression for <m>g</m> is the local acceleration due to gravity is a little tricky,
          but we can see,
          using the fact that <m>G</m> has units <m>m^3/(kg \cdot s^2)</m>,
          that the units of <m>g</m> are <m>m/s^2</m>,
          so it is an acceleration term).
        </p>
      </statement>
    </example>
    <example>
      <statement>
        <p>
          For another example,
          consider the rotational flow <m>F(x,y) = (-y,x)</m> and
          <m>\gamma(t)</m> the counterclockwise circle
          <m>(r \cos t, r \sin t)</m> for <m>t \in [0, 2\pi]</m>.
          <md>
            <mrow>\gamma^\prime(t) \amp  = (-r \sin t, r \cos t)</mrow>
            <mrow>F(\gamma(t)) \amp  = (-r\sin t, r \cos t)</mrow>
            <mrow>F(\gamma(t)) \cdot \gamma^\prime(t) \amp  = r^2 \sin^2 t + r^2 \cos^2 r = r^2</mrow>
            <mrow>\int_{\gamma} F \cdot ds \amp  = \int_0^{2\pi} r^2 dr = 2\pi r^2</mrow>
          </md>
        </p>
        <p>
          The work to more around the circle
          (with the vector field)
          of radius <m>r</m> is <m>2\pi r^2</m>.
          Since it is positive and follows the integral curve,
          we can think of it as the work the field accomplished to move the object along its integral curve.
        </p>
      </statement>
    </example>
  </introduction>
  <subsection xml:id="fundamental-theorems">
    <title>Fundamental Theorems</title>
    <p>
      Let's return to a version of the Fundamental Theorm of Calculus.
      Let <m>f(x)</m> be a differentiable function.
      <me>
        \int_a^b \frac{df}{dx} dx = f(b) - f(a)
      </me>
    </p>
    <p>
      This integration takes place on the interval <m>[a,b]</m> and is evaluated at the end points <m>a</m> and <m>b</m>.
      We can think of the endpoints as the
      <em>boundary</em> of the interval.
      With this perspective,
      the left side is the integral of some kind of derivative and the right side is the evaluation of the original function on a boundary.
      If we let <m>df</m> be any kind of derivative,
      and <m>\int_{\del S}</m> be an integral which relates to the boundary of a set,
      then when can write the archtypical form of this theorem.
      <me>
        \int_S df = \int_{\del S} f
      </me>
    </p>
    <p>
      For the fundamental theorem,
      the <sq>integral</sq> on the right-hand side is just evaluation,
      since the boundary is only the two points.
      Integration over a zero-dimensional regions,
      such as a set of points, is just evaluation.
      Using this integration notation,
      the fundamental theorem is only the first of a whole family of theorems of this type.
      They all relate a derivative operator on the left to a boundary operator on the right.
    </p>
  </subsection>
  <subsection xml:id="fundamental-theorem-line-integrals">
    <title>The Fundamental Theorem of Line Integrals</title>
    <p>
      The first of these new fundamental theorems comes from thinking about line integrals of paths through conservative vector fields.
    </p>
    <theorem>
      <statement>
        <p>
          Let <m>F = \nabla f</m> be a conservative vector field with potential <m>f</m> and let
          <m>\gamma(t): [a,b] \rightarrow \RR^n</m> be a parametric curve.
          The fundamental theorem of line integrals shows we can solve this integral by evaluation on the endpoints of the curve.
          <me>
            \int_{\gamma} F \cdot ds = f(\gamma(b)) - f(\gamma(a))
          </me>
        </p>
      </statement>
    </theorem>
    <proof>
      <p>
        We calculate the integral in steps.
        <md>
          <mrow>\int_{\gamma} F \cdot ds \amp  = \int_{\gamma} \nabla f \cdot T ds</mrow>
          <mrow>\amp  \int_a^b \nabla f(\gamma(t)) \cdot \gamma^\prime(t) dt</mrow>
          <mrow>\amp  = \int_a^b \left( \frac{\del f}{\del x} (\gamma(t)), \frac{\del f}{\del y} (\gamma(t)), \frac{\del f}{\del z} (\gamma(t)) \right) \cdot \left( \gamma_1^\prime(t), \gamma_2^\prime(t), \gamma_3^\prime(t) \right) dt</mrow>
          <mrow>\amp  = \int_a^b \frac{\del f}{\del x} (\gamma(t)) \gamma_1^\prime(t) + \frac{\del f}{\del y} (\gamma(t)) \gamma_2^\prime(t) + \frac{\del f}{\del z} (\gamma(t)) \gamma_3^\prime(t) dx</mrow>
          <mrow>\amp  = \int_a^b \frac{d}{dt} \left( f(\gamma(t)) \right) dt</mrow>
          <mrow>\amp  = f(\gamma(b)) - f(\gamma(a))</mrow>
        </md>
      </p>
      <p>
        We used multi-variable chain rule in the fourth line of the calculation.
      </p>
    </proof>
    <p>
      Side by side,
      we can see the similarity of the theorem with the original fundamental theorem:
      derivatives on one side and
      (evaluation on)
      boundaries on the other side.
      <md>
        <mrow>\int_a^b \frac{df}{dx} dx \amp  = f(b) - f(a)</mrow>
        <mrow>\int_{\gamma} \nabla f \cdot ds \amp  = f(\gamma(b)) - f(\gamma(a))</mrow>
      </md>
    </p>
  </subsection>
  <subsection xml:id="implications-conservative">
    <title>Implications for Conservative Vector Fields</title>
    <p>
      The fundamental theorem for line integral applies to conservative vector fields:
      it says that the integral of a conservative vector field can be calculated simply by evaluation on the end points.
      That means all the points on the path inbetween are irrelevant!
    </p>
    <proposition>
      <statement>
        <p>
          Let <m>F = \nabla f</m> be a conservative vector field.
          Then line integrals of <m>F</m> are
          <em>path-independent</em>.
          Their value only depends on the endpoints.
        </p>
      </statement>
    </proposition>
    <p>
      No matter how strange the path is,
      no matter how many times it loops around and goes elsewhere,
      only the endpoints matter.
      If <m>f</m> is potential energy,
      then <m>f(\gamma(b)) - f(\gamma(a))</m> is the potential energy at the end less the potential energy at the start.
      This difference is the change in potential energy.
      The work to move through the force field is equal to the change in potential energy.
      The work can be defined in terms of kinetic energy lost or gained,
      so this says that the kinetic energy lost or gained is equal to the change in potential energy.
      Therefore, energy is conserved!
      This explains the term <sq>conservative vector field</sq>:
      these are vector fields where conservation of energy makes sense.
      (As before, there are sign issues in the fiction of energy and work:
      we may need to take the negative of the usual or expected potential energy to make conservation of energy make sense.)
    </p>
    <p>
      We can calculate very explicitly in terms of the gain in kinetic energy as well.
      Let <m>F = \nabla f</m> be a conservative force.
      Then <m>F = ma</m>, where <m>a</m> is acceration.
      Also, if <m>\gamma</m> is a curve representing movement,
      then <m>\gamma^{\prime \prime}</m> is the acceleration.
      Then we look carefully at the change in potential energy using our new theorem.
      <md>
        <mrow>-\Delta PE \amp  = f(\gamma(b)) - f(\gamma(a))</mrow>
        <mrow>\amp  = \int_{\gamma} F \cdot T ds</mrow>
        <mrow>\amp  = \int_a^b m \gamma^{\prime \prime}(t) \cdot \gamma^\prime(t) dt</mrow>
        <mrow>\amp  = \frac{m}{2} \int_a^b \frac{d}{dt} (\gamma^\prime(t) \cdot \gamma^\prime(t)) dt</mrow>
        <mrow>\amp  = \frac{m}{2} \int_a^b \frac{d}{dt} |\gamma^\prime(t)|^2 dt</mrow>
        <mrow>\amp  = \frac{m}{2} |\gamma^\prime(t)|^2 \bigg|_a^b</mrow>
        <mrow>\amp  = \frac{mv_b^2}{2} - \frac{mv_a^2}{2} = \Delta KE</mrow>
      </md>
    </p>
    <p>
      Previously, we saw that conservative vector fields we irrotational and,
      conversely,
      an irrotation field <em>defined on a simply connected set</em>
      was guaranteed to be conservative.
      We now have a new characterization of conversative fields:
      their line integrals are path independent.
      We can similarly ask if the converse holds and again,
      we find a topological condition.
      First, we start with a slightly more narrow proposition.
    </p>
    <proposition>
      <statement>
        <p>
          Let <m>F</m> be a vector field on <m>U</m> an open path-connected set in <m>\RR^n</m>.
          If <m>\int_{\gamma} F = 0</m> for <em>all</em>
          closed paths <m>\gamma</m> in <m>U</m>,
          then <m>F</m> is conservative.
        </p>
      </statement>
    </proposition>
    <p>
      A full characterization of conservative fields is given by this more-complete proposition.
    </p>
    <proposition>
      <statement>
        <p>
          Let <m>F</m> be a vector field on <m>U</m> an open simply-connected set in <m>\RR^n</m> and let
          <m>\gamma: [a,b] \rightarrow U</m> be a parametric curve.
          The following four conditions are equivalent.
          <ol>
            <li>
              <p>
                <m>F</m> is conservative on <m>U</m>. (By definition,
                this means <m>F = \nabla f</m> for a scalar field <m>f</m>).
              </p>
            </li>
            <li>
              <p>
                The line integrals of <m>F</m> are path independent in <m>U</m>.
              </p>
            </li>
            <li>
              <p>
                The line integral of <m>F</m> is zero for any closed path in <m>U</m>.
              </p>
            </li>
            <li>
              <p>
                <m>\nabla \times F = 0</m>.
              </p>
            </li>
          </ol>
        </p>
      </statement>
    </proposition>
  </subsection>
  <subsection xml:id="conservative-examples">
    <title>Examples of Conservative Vector Fields</title>
    <example>
      <statement>
        <p>
          If <m>F = (y \cos (xy),
          x \cos (xy), 2z)</m> then <m>F</m> is defined on <m>\RR^3</m>,
          which is simply connected.
          <md>
            <mrow>\nabla \times F \amp  = \left( \frac{\del}{\del y} 2z - \frac{\del}{\del z} x \cos (xy), \frac{\del}{\del z} y \cos (xy) - \frac{\del}{\del x} 2z, \frac{\del}{\del x} x \cos (xy) - \frac{\del}{\del y} y \cos (xy) \right)</mrow>
            <mrow>\amp  = (0, 0, \cos xy - xy \sin xy - \cos xy + xy \sin xy) = (0,0,0)</mrow>
          </md>
        </p>
        <p>
          Therefore, <m>F</m> is a conservative field.
          We can try to calculate its potential.
          <md>
            <mrow>f \amp  = \int y \cos (xy) dx + g_1(y,z) = \sin (xy) + g_1(x,y)</mrow>
            <mrow>f \amp  = \int x \cos (xy) dy + g_2(x,z) = \sin (xy) + g_2(x,z)</mrow>
            <mrow>f \amp  = \int 2z dz + g_3(x,y) = z^2 + g_3(x,y)</mrow>
            <mrow>f \amp  = \sin xy + z^2 + c</mrow>
          </md>
        </p>
        <p>
          We can check <m>\nabla f</m> to see that we recover the original field <m>F</m>.
        </p>
      </statement>
    </example>
    <example>
      <statement>
        <p>
          If <m>F = (3y^z - 8xz^2 + 3x^2 y, 6xyz + x^3 + 2yz^2, 3xy^2 - 8x^2z + 2y^2z)</m>,
          then <m>F</m> is defined on all <m>\RR^3</m>.
          <me>
            \nabla \times F = (6xy+4yz-6xy-4yz, 3y^2 -16z -3y^2 + 16z, 6yz + 3x^2 - 3yz - 3x^2) = (0,0,0)
          </me>
        </p>
        <p>
          Therefore, <m>F</m> is conservative.
          We can try to calculate its potential.
          <md>
            <mrow>f \amp  = \int F_1 dx = 3xy^2 z - 4x^2 + z^2 + x^3 y + g_1(y,z)</mrow>
            <mrow>f \amp  = \int F_2 dy = 3xy^2 z + x^3 y + y^2 z^2 + g_2(x,z)</mrow>
            <mrow>f \amp  = \int F_3 dz = 3xy^2 z - 4x^2 z^2 + y^2 z^2 + g_3 (x,y)</mrow>
            <mrow>f \amp  = 3xy^2 z - 4x^2 z^2 + x^3 y + y^2 z^2 + c</mrow>
          </md>
        </p>
      </statement>
    </example>
  </subsection>
</section>